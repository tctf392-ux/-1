<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<title>é‡‘é¸¿é›†å›¢ Â· å®Œæ•´è´¦å•</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
body{margin:0;background:#0b0f14;color:#e6edf3;font-family:system-ui}
.wrap{max-width:960px;margin:auto;padding:16px}
.card{background:#111823;border:1px solid #1f2a37;border-radius:14px;padding:14px;margin-bottom:12px}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
input,button{background:#0b1220;color:#e6edf3;border:1px solid #263244;border-radius:10px;padding:10px}
button{cursor:pointer}
button.primary{background:#d11d2a;border-color:#d11d2a}
pre{background:#0b1220;border:1px solid #263244;border-radius:12px;padding:12px;white-space:pre-wrap}
.pill{padding:6px 10px;border-radius:999px;border:1px solid #263244}
.err{color:#ff6b73}
</style>
</head>

<body>
<div class="wrap">

<div class="card">
  <div class="row" style="justify-content:space-between">
    <div>ğŸ“’ é‡‘é¸¿é›†å›¢ Â· å®Œæ•´è´¦å•</div>
    <span id="status" class="pill">æœªåŠ è½½</span>
  </div>
</div>

<div class="card">
  <div class="row">
    <input id="k" placeholder="è¾“å…¥è´¦å• k" style="flex:1"/>
    <button class="primary" onclick="load()">åŠ è½½è´¦å•</button>
  </div>
  <div id="err" class="err"></div>
</div>

<div class="card">
<pre id="out">ç­‰å¾…åŠ è½½â€¦</pre>
</div>

</div>

<script>
const statusEl = document.getElementById("status");
const out = document.getElementById("out");
const err = document.getElementById("err");
const kInput = document.getElementById("k");

function setStatus(t, ok=true){
  statusEl.textContent = t;
  statusEl.style.borderColor = ok ? "#263244" : "#ff6b73";
}

async function load(){
  const k = kInput.value.trim();
  if(!k){ err.textContent="è¯·è¾“å…¥ k"; return; }
  err.textContent="";
  setStatus("åŠ è½½ä¸­â€¦");
  out.textContent="åŠ è½½ä¸­â€¦";

  // âœ…ã€å…³é”®ã€‘ç»å¯¹è·¯å¾„ + åŒ bills
  const url = `/ -1 /bills/bills/${encodeURIComponent(k)}.json?t=${Date.now()}`;

  try{
    const r = await fetch(url,{cache:"no-store"});
    if(!r.ok) throw new Error("HTTP "+r.status);
    const j = await r.json();
    out.textContent = JSON.stringify(j,null,2);
    setStatus("å·²åŠ è½½ âœ…");
  }catch(e){
    setStatus("åŠ è½½å¤±è´¥ âŒ",false);
    err.textContent="æ‰¾ä¸åˆ°è´¦å•æ–‡ä»¶ï¼š"+url;
    out.textContent="";
  }
}

const qp = new URLSearchParams(location.search);
if(qp.get("k")){
  kInput.value = qp.get("k");
  load();
}
</script>
</body>
</html>
